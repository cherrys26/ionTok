<app-header></app-header>
<ion-content class="add-video-content">
  <!-- Step 1: Select Video -->
  <div *ngIf="!isVideoSelected" class="upload-container">
    <div class="file-input-container">
      <input type="file" accept="video/*" (change)="onFileSelected($event)" #fileInput hidden />
      <ion-icon name="cloud-upload-outline" class="upload-icon"></ion-icon>
      <p class="upload-text">Select a Video</p>
    </div>
    <ion-button (click)="fileInput.click()" expand="block" class="record-button">
      Select Video
    </ion-button>
  </div>

  <!-- Cancel Button when video is selected -->
  <ion-button *ngIf="isVideoSelected" class="cancel-button" (click)="cancel()" fill="clear" color="danger">
    Cancel
  </ion-button>

  <!-- Step 2: Show Video and Add Description -->
  <div *ngIf="isVideoSelected && !isDescriptionAdded" class="video-edit-container">
    <div class="video-container" *ngIf="videoUrl">
      <video [src]="videoUrl" controls></video>
    </div>

    <ion-item>
      <ion-label position="floating">Add a Description (max 300 characters)</ion-label>
      <ion-textarea [(ngModel)]="description" maxlength="300"></ion-textarea>
    </ion-item>
    <p class="character-count">{{ description.length }}/300 characters</p>

    <ion-button expand="full" [disabled]="description.length > 300 || description.length === 0" 
                (click)="proceedToReview()">Next: Review</ion-button>
  </div>

  <!-- Step 3: Review and Submit -->
  <div *ngIf="isDescriptionAdded" class="review-container">
    <div class="video-container" *ngIf="videoUrl">
      <video [src]="videoUrl" controls></video>
    </div>
    <p class="description-preview"><strong>Description:</strong> {{ description }}</p>

    <ion-button expand="full" (click)="submit()">Submit</ion-button>
    <ion-button expand="full" color="light" (click)="goBackToEdit()">Go Back</ion-button>
  </div>
</ion-content>
