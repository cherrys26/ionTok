<app-header></app-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <!-- Full Page Loading Spinner -->
  <div *ngIf="isLoading" class="loading-container">
    <ion-spinner name="crescent"></ion-spinner>
  </div>

  <div class="ion-padding-vertical container" *ngIf="!isLoading">
    <ion-avatar class="avatar">
      <img [src]="userProfile.imageUrl || 'https://ionicframework.com/docs/img/demos/avatar.svg'" 
           alt="User Profile Image" class="image-round" />
    </ion-avatar>
    <div class="ion-text-center username">
      <ion-text>&#64;{{ userProfile.userName }}</ion-text>
    </div>

    <ion-grid fixed>
      <ion-row class="ion-no-padding">
        <ion-col size="6">
          <div class="ion-text-center">
            <span><strong>0</strong></span> <br />
            <small>Following</small>
          </div>
        </ion-col>
        <ion-col size="6">
          <div class="ion-text-center">
            <span><strong>0</strong></span> <br />
            <small>Followers</small>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>

    <div *ngIf="userProfile?.isLoggedInUser" class="btn-edit ion-text-center">
      <a routerLink="/settings-and-privacy">
        <ion-icon size="large" name="cog-outline"></ion-icon>
      </a>
    </div>

    <div *ngIf="userProfile && !userProfile.isLoggedInUser" class="btn-edit ion-text-center">
      <ion-button color="primary">Follow</ion-button>
    </div>
  </div>

  <div class="segment" *ngIf="!isLoading">
    <ion-segment (ionChange)="segmentChanged($event)" color="dark" mode="md" value="challenges">
      <ion-segment-button value="challenges">Challenges</ion-segment-button>
      <ion-segment-button value="responses">Responses</ion-segment-button>
      <ion-segment-button value="likes" [disabled]="!loadedData.likes || !likes.length">Likes</ion-segment-button>
    </ion-segment>

    <!-- Challenges Segment -->
    <div *ngIf="selectedSegment === 'challenges'">
      <div *ngIf="segmentLoading; else challengesList">
        <div class="segment-loading">
          <ion-spinner name="crescent"></ion-spinner>
        </div>
      </div>
      <ng-template #challengesList>
        <ion-grid class="ion-no-padding ion-no-margin">
          <ion-row>
            <ion-col size="4" *ngFor="let challenge of challenges; let i = index">
              <ion-card (click)="onChallengeClick(i)">
                <img [src]="challenge.thumbnailUrl || 'https://i.pinimg.com/originals/64/eb/ef/64ebefbbd558d77f1a1e0d01a4e050c1.png'" 
                     alt="Challenge Thumbnail" />
              </ion-card>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ng-template>
    </div>

    <!-- Responses Segment -->
    <div *ngIf="selectedSegment === 'responses'">
      <div *ngIf="segmentLoading; else responsesList">
        <div class="segment-loading">
          <ion-spinner name="crescent"></ion-spinner>
        </div>
      </div>
      <ng-template #responsesList>
        <ion-grid>
          <ion-row>
            <ion-col size="4" *ngFor="let response of responses">
              <ion-card (click)="onResponseClick(response.guid)">
                <img [src]="response.thumbnailUrl" alt="Response Thumbnail" />
              </ion-card>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ng-template>
    </div>

    <!-- Likes Segment -->
    <div *ngIf="selectedSegment === 'likes'">
      <div *ngIf="segmentLoading; else likesList">
        <div class="segment-loading">
          <ion-spinner name="crescent"></ion-spinner>
        </div>
      </div>
      <ng-template #likesList>
        <ion-grid>
          <ion-row>
            <ion-col size="4" *ngFor="let like of likes">
              <ion-card>
                <img [src]="like.thumbnailUrl" alt="Like Thumbnail" />
              </ion-card>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ng-template>
    </div>
  </div>
</ion-content>
